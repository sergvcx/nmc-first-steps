@SHELL@
@INCLUDE_MK@
OS_RM    = @OS_RM@ 
.SUFFIXES:


TARGET   = @TARGET@.abs
TARGETD  = @TARGET@d.abs

CC       = nmc-gcc
AS       = nmc-gcc
CXXFLAGS = @CXXFLAGS@
LIBS     = @LIBS@
LIBSD    = @LIBSD@ 
LDFLAGS  = -Wl,-Map=@TARGET@.map  -Wl,-T@LDS@
LDFLAGSD = -Wl,-Map=@TARGET@d.map -Wl,-T@LDS@ 
INC_DIRS = -I"$(@BSP@)/include" -I../../../include -I..
LIB_DIRS = -L"$(@BSP@)/lib" 
SOURCES  = @SRC_FILES@

.DEFAULT_GOAL := all

all: @TARGETS@

$(TARGET): $(SOURCES) Makefile 
	@echo ------ build release --------------
	$(CC)  -o$(TARGET) $(CXXFLAGS) $(LDFLAGS)  $(INC_DIRS) $(LIB_DIRS)  $(SOURCES) $(LIBS)
	nmc-objdump -D $(TARGET) > dasm.txt

$(TARGETD): $(SOURCES) Makefile 
	@echo ------ build debug ----------------
	$(CC)  -o$(TARGETD) $(CXXFLAGS) $(LDFLAGSD) $(INC_DIRS) $(LIB_DIRS) $(SOURCES) $(LIBSD) 


run: $(TARGET)
	@RUN@ $(TARGET)

rund: $(TARGETD) 
	@RUND@ $(TARGETD)

@MONITOR@
	
@GDB@


clean: 
	-$(OS_RM) *.abs *.elf *.map 
	

